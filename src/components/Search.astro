---
export interface Props {
  placeholder?: string;
  showButton?: boolean;
}

const { placeholder = "搜索文档", showButton = true } = Astro.props;
---

<div class="search-container">
  <div class="search-box">
    <input 
      type="text" 
      placeholder={placeholder} 
      class="search-input" 
      id="searchInput"
      autocomplete="off"
    />
    {showButton && (
      <button class="search-button" id="searchButton">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
        <span class="search-button-text">搜索</span>
      </button>
    )}
  </div>
</div>

<script>
  // 搜索框事件监听
  const searchInput = document.getElementById('searchInput') as HTMLInputElement;
  const searchButton = document.getElementById('searchButton');

  // 搜索按钮点击事件
  searchButton?.addEventListener('click', function() {
    const query = searchInput.value.trim();
    if (query) {
      // 跳转到搜索结果页面
      window.location.href = `./search?q=${encodeURIComponent(query)}`;
    }
  });

  // 回车键搜索
  searchInput?.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      const query = this.value.trim();
      if (query) {
        // 跳转到搜索结果页面
        window.location.href = `./search?q=${encodeURIComponent(query)}`;
      }
    }
  });
</script>
